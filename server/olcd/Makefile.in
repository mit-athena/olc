# $Id: Makefile.in,v 1.1 1999-03-06 16:48:50 ghudson Exp $
#
# Copyright (C) 1999 by the Massachusetts Institute of Technology.
# For copying and distribution information, see the file "mit-copyright.h".

SHELL=/bin/sh
VPATH=@srcdir@

INSTALL=@INSTALL@
INSTALL_PROGRAM=@INSTALL_PROGRAM@
srcdir=@srcdir@
top_srcdir=@top_srcdir@
prefix=@prefix@
exec_prefix=@exec_prefix@
bindir=@bindir@
sbindir=@sbindir@

CC=@CC@
PURIFY=
LD=${PURIFY} ${CC}
DEFS=@DEFS@
CPPFLAGS=@CPPFLAGS@ -I@top_srcdir@/include
CFLAGS=@CFLAGS@
LDFLAGS=@LDFLAGS@
LIBS=$(LOCAL_LIBS) @ZEPHYR_LIBS@ @HESIOD_LIBS@ @KRB4_LIBS@ @LIBS@
ALL_CFLAGS=${CPPFLAGS} ${CFLAGS} ${DEFS}

PARSERLIB=${top_srcdir}/clients/parser/libparser.a
TTYLIB=${top_srcdir}/clients/tty/libtty.a
CLIENTLIB=${top_srcdir}/clients/lib/libclient.a
COMMONLIB=${top_srcdir}/common/libcommon.a
CONFIGLIB=${top_srcdir}/cfgfile/libcfgfile.a
LOGGERLIB=${top_srcdir}/logger/liblogger.a
LOCAL_LIBS=$(COMMONLIB)

SRCS=backup.c backup-bin.c backup-dump.c data_utils.c db.c s_io.c log.c	    \
  olcd.c data.c notify.c utils.c list.c acl_files.c requests_olc.c syslog.c \
  statistics.c motd.c requests_admin.c version.c
OBJS=backup.o backup-bin.o backup-dump.o data_utils.o db.o s_io.o log.o	    \
  olcd.o data.o notify.o utils.o list.o acl_files.o requests_olc.o syslog.o \
  statistics.o motd.o requests_admin.o version.o

all: olcd

olcd: version.h $(OBJS)
	${LD} ${LDFLAGS} $(OBJS) ${LIBS} -o $@

.c.o:
	${CC} -c ${ALL_CFLAGS} $<

FORCE:
version.h: FORCE
	sh newvers.sh

install:
	${top_srcdir}/mkinstalldirs ${DESTDIR}${sbindir}
	${INSTALL_PROGRAM} olcd ${DESTDIR}${sbindir}

clean:
	rm -f $(OBJS) olcd version.h

distclean: clean
	rm -f Makefile

depend.in: version.h Makefile.in
	makedepend -f Makefile.in ${CPPFLAGS} ${DEFS} *.[ch]
